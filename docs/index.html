<!DOCTYPE html><html><head><title>Learn how to read call metadata and download call recordings using Node JS- RingCentral Developer Tutorials</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="apple-touch-icon" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="apple-touch-icon" sizes="72x72" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="apple-touch-icon" sizes="114x114" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/jquery-ui@1.12.1/themes/base/all.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div class="dpw-header-container"><div class="dpw-header center-section"><div class="logo"><a href="https://developers.ringcentral.com" class="logo-link"></a></div><div class="nav-top-menus"></div><div class="dpw-login-section"><a href="https://developer.ringcentral.com/login.html#/">Sign in | Sign up</a></div></div></div><div id="viewsaurus" data-title="Learn how to read call metadata and download call recordings using Node JS"><div class="saurus-panes"><div class="saurus-panes-header"><a href="https://ringcentral.github.io/tutorials/" class="saurus-back-to-tutorials">Tutorials</a><span>&gt;</span><span>Learn how to read call metadata and download call recordings using Node JS</span></div><div class="saurus-prose"><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw icon-menu"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>Learn how to use the Engage Voice Platform APIs to read call metadata and download call recording files. Click the &quot;Start Tutorial&quot; button below to start.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Engage Voice Read Call Data Tutorial" class="chapter"><div data-title="Welcome!" data-file="../README.md" data-highlight="1-2" class="step"><h2 id="welcome-to-the-tutorial">Welcome to the tutorial</h2>
<p>This tutorial shows how to use Engage Voice platform APIs to read call history metadata, save the data into a CSV formatted file and download call recording files to a local machine.</p>
<p>To try out the tutorial code, you must have the following setups:</p>
<ul>
<li><p>A RingCentral Engage Voice account.</p>
</li>
<li><p>A RingCentral Office account and a RingCentral developer account. Your RingCentral Office account must be associated with your Engage Voice account. This means that you are be able to login your Engage Voice account using your RingCentral Office login credentials.</p>
</li>
<li><p>You also have to <a href="https://developer.ringcentral.com/library/getting-started.html">create a RingCentral app</a> with the &quot;ReadAccounts&quot; permissions. And retrieve your app ClientId and ClientSecret for using with this tutorial. Remember to choose &quot;Server-only (No UI)&quot; for the app&#39;s platform type and &quot;Password flow&quot; for the Authorization flows.</p>
</li>
</ul>
</div><div data-title="Clone the Project" data-file="../README.md" data-highlight="4-10" class="step"><h2 id="clone-the-project-from-github">Clone the project from GitHub</h2>
<p>Run the commands shown on the right-hand side to clone the project from GitHub</p>
<p>Navigate to the folder and install the dependencies</p>
<p>Rename the dotenv to .env, open it and provide your app credentials as well as your user login credentials.</p>
<p><strong>Important</strong>: You must run the app on your production environment, make sure that your app is graduated and use the app production clientId and clientSecret.</p>
</div></div><div data-title="Project Setup" data-file="../dotenv" class="step"><h2 id="specify-app-and-user-login-credentials">Specify app and user login credentials</h2>
<p>Open the .env file and provide valid app and user login credentials</p>
</div><div data-title="Use the EngageVoice SDK Wrapper" data-file="../index.js" data-highlight="1-15" class="step"><h2 id="use-the-engage-voice-sdk-wrapper">Use the Engage Voice SDK Wrapper</h2>
<p>First, we create the EngageVoice instance <code>ev</code> and initialize it with the clientId and clientSecret.</p>
<p>Then we call the <code>ev.login()</code> function to login Engage Voice platform with a valid RingCentral username, password and extension number (if required).</p>
</div><div data-title="Read Account Call History" data-file="../index.js" data-highlight="17-33" class="step"><h2 id="read-account-call-history">Read Account Call History</h2>
<p>To read the account call history metadata, we call the <strong>admin/accounts/[accountId]/json</strong> endpoint with the body parameters specified as shown on the right-hand side.</p>
<p>We specify the <strong>startDate</strong> and the <strong>endDate</strong> query parameters to define the date and time range when phone calls were made.</p>
</div><div data-title="Parse the Response" data-file="../index.js" data-highlight="38-64" class="step"><h2 id="parse-the-json-response">Parse the JSON Response</h2>
<p>In this tutorial, we convert the JSON response into a .csv formatted with the metadata we are interested at. We are also interested only at calls with call recording and that is why we check if the __callRecordingUrl_ exists.</p>
<p>After parsing all the calls&#39; metadata, we save the content in a .csv file and proceed to downloading call recordings.</p>
</div><div data-title="Download Call Recordings" data-file="../index.js" data-highlight="69-92" class="step"><h2 id="download-call-recordings">Download Call Recordings</h2>
<p>The SDK wrapper provides a function <strong>save_call_recording(sourceUrl, fileName, ...)</strong> which download and save a call recording to a local folder.</p>
<p>In this tutorial, we want to download and save call recordings to a <code>recordings</code> folder and use the same source file name, which is the call&#39;s unique id <code>uii</code> and the index of call recording of the call.</p>
</div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="../README.md" data-mode="markdown">IyBSZWFkIGNhbGwgbWV0YWRhdGEgYW5kIGNhbGwgcmVjb3JkaW5nClJlYWQgRW5nYWdlIFZvaWNlIGFnZW50cycgY2FsbCBtZXRhZGF0YSBhbmQgZG93bmxvYWQgY2FsbCByZWNvcmRpbmdzLgoKIyMgQ2xvbmUgLSBTZXR1cCAtIFJ1biB0aGUgcHJvamVjdApgYGAKJCBnaXQgY2xvbmUgaHR0cHM6Ly9naXRodWIuY29tL3JpbmdjZW50cmFsLXR1dG9yaWFscy9lbmdhZ2V2b2ljZS1jYWxsLXJlY29yZGluZ3Mtbm9kZQokIGNkIGVuZ2FnZXZvaWNlLWNhbGwtcmVjb3JkaW5ncy1ub2RlCiQgbnBtIGluc3RhbGwgLS1zYXZlCiQgY3AgZG90ZW52IC5lbnYKYGBgCg==</textarea>
<textarea class="saurus-file" data-file="../dotenv" data-mode="text">UkNfQVBQX0NMSUVOVF9JRD1Zb3VyX0FwcF9Qcm9kdWN0aW9uX0NsaWVudElEClJDX0FQUF9DTElFTlRfU0VDUkVUPVlvdXJfQXBwX1Byb2R1Y3Rpb25fQ2xpZW50U2VjcmV0CgpSQ19VU0VSTkFNRT1Zb3VyX1Byb2R1Y3Rpb25fQWNjb3VudF9Vc2VyTmFtZQpSQ19QQVNTV09SRD1Zb3VyX1Byb2R1Y3Rpb25fQWNjb3VudF9QYXNzd29yZApSQ19FWFRFTlNJT05fTlVNPVlvdXJfUHJvZHVjdGlvbl9FeHRlbnNpb25OdW1iZXIK</textarea>
<textarea class="saurus-file" data-file="../index.js" data-mode="javascript">Y29uc3QgZnMgPSByZXF1aXJlKCdmcycpCmNvbnN0IGFzeW5jID0gcmVxdWlyZSgnYXN5bmMnKQpjb25zdCBFbmdhZ2VWb2ljZSA9IHJlcXVpcmUoJ2VuZ2FnZXZvaWNlLXNkay13cmFwcGVyJykKCnJlcXVpcmUoJ2RvdGVudicpLmxvYWQoKQoKdmFyIGV2ID0gbmV3IEVuZ2FnZVZvaWNlLlJlc3RDbGllbnQocHJvY2Vzcy5lbnYuUkNfQVBQX0NMSUVOVF9JRCwgcHJvY2Vzcy5lbnYuUkNfQVBQX0NMSUVOVF9TRUNSRVQpCgpldi5sb2dpbihwcm9jZXNzLmVudi5SQ19VU0VSTkFNRSwgcHJvY2Vzcy5lbnYuUkNfUEFTU1dPUkQsIHByb2Nlc3MuZW52LlJDX0VYVEVOU0lPTl9OVU0sIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpewogICAgaWYgKGVycikKICAgICAgY29uc29sZS5sb2coZXJyKQogICAgZWxzZXsKICAgICAgcmVhZF9jYWxsX3JlY29yZGluZygpCiAgICB9Cn0pCgpmdW5jdGlvbiByZWFkX2NhbGxfcmVjb3JkaW5nKCl7CiAgICB2YXIgZW5kcG9pbnQgPSAnYWRtaW4vYWNjb3VudHMvfi9qc29uJwogICAgdmFyIHBhcmFtcyA9IHsKICAgICAgICAgICAgcmVwb3J0VHlwZTogIkdMT0JBTF9DQUxMX1RZUEVfRVhDRUwiLAogICAgICAgICAgICByZXBvcnRDcml0ZXJpYTogewogICAgICAgICAgICAgICAgY3JpdGVyaWFUeXBlOiAiR0xPQkFMX0NBTExfVFlQRV9DUklURVJJQSIsCiAgICAgICAgICAgICAgICBzdGFydERhdGU6ICIyMDIwLTA1LTEyVDAwOjAwOjAwLjAwMC0wMDAwIiwKICAgICAgICAgICAgICAgIGVuZERhdGU6ICIyMDIwLTA1LTEzVDIzOjU5OjU5Ljk5OS0wMDAwIiwKICAgICAgICAgICAgICAgIGNvbnRhaW5HYXRlczogdHJ1ZSwKICAgICAgICAgICAgICAgIGNvbnRhaW5DYW1wYWlnbnM6IHRydWUsCiAgICAgICAgICAgICAgICBjb250YWluSXZyU3R1ZGlvczogdHJ1ZSwKICAgICAgICAgICAgICAgIGNvbnRhaW5DbG91ZFByb2ZpbGVzOiB0cnVlLAogICAgICAgICAgICAgICAgY29udGFpblRyYWNOdW1iZXJzOiB0cnVlLAogICAgICAgICAgICAgICAgY29udGFpbkFnZW50czogdHJ1ZSwKICAgICAgICAgICAgICAgIGluY2x1ZGVOb0Fuc3dlcnM6IGZhbHNlCiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICBldi5wb3N0KGVuZHBvaW50LCBwYXJhbXMsIGZ1bmN0aW9uKGVyciwgcmVzcG9uc2UpewogICAgICAgIGlmIChlcnIpewogICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpCiAgICAgICAgfWVsc2UgewogICAgICAgICAgICB2YXIganNvbk9iaiA9IEpTT04ucGFyc2UocmVzcG9uc2UpCiAgICAgICAgICAgIHZhciBjYWxsUmVjb3JkaW5nVXJscyA9IFtdCiAgICAgICAgICAgIHZhciBjc3YgPSAidWlpLHNvdXJjZV90eXBlLGFuaSxkbmlzLGNhbGxfc3RhdHVzLGNhbGxfcmVzdWx0LHF1ZXVlX3RpbWUsY2FsbF9kdXJhdGlvbixjYWxsX3N0YXJ0LGNhbGxfZW5kIgogICAgICAgICAgICBmb3IgKHZhciBpdGVtIG9mIGpzb25PYmopewogICAgICAgICAgICAgIGlmIChpdGVtLnJlY29yZGluZ1VybCAmJiBpdGVtLnJlY29yZGluZ1VybC5sZW5ndGgpewogICAgICAgICAgICAgICAgY3N2ICs9ICJcclxuIiArIGl0ZW0udWlpICsgIiwiCiAgICAgICAgICAgICAgICBjc3YgKz0gaXRlbS5zb3VyY2VUeXBlICsgIiwiCiAgICAgICAgICAgICAgICBjc3YgKz0gaXRlbS5hbmkgKyAiLCIKICAgICAgICAgICAgICAgIGNzdiArPSBpdGVtLmRuaXMgKyAiLCIKICAgICAgICAgICAgICAgIGNzdiArPSBpdGVtLmNhbGxTdGF0dXMgKyAiLCIKICAgICAgICAgICAgICAgIGNzdiArPSBpdGVtLmNhbGxSZXN1bHQgKyAiLCIKICAgICAgICAgICAgICAgIGNzdiArPSBpdGVtLnF1ZXVlVGltZSArICIsIgogICAgICAgICAgICAgICAgY3N2ICs9IGl0ZW0uY2FsbER1cmF0aW9uICsgIiwiCiAgICAgICAgICAgICAgICBjc3YgKz0gaXRlbS5jb25uZWN0ZWREdXJhdGlvbiArICIsIgogICAgICAgICAgICAgICAgY3N2ICs9IGl0ZW0ucmVjb3JkaW5nVXJsICsgIiwiCiAgICAgICAgICAgICAgICBjc3YgKz0gaXRlbS5jYWxsU3RhcnREdHMgKyAiLCIKICAgICAgICAgICAgICAgIGNzdiArPSBpdGVtLmNhbGxFbmREdHMgKyAiLCIKICAgICAgICAgICAgICAgIGNzdiArPSBpdGVtLmNvbm5lY3RlZER0cyArICIsIgogICAgICAgICAgICAgICAgY2FsbFJlY29yZGluZ1VybHMucHVzaChpdGVtLnJlY29yZGluZ1VybCkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgZnMud3JpdGVGaWxlKCJhcmNoaXZlcy9zYW1wbGUtZGF0YS5jc3YiICwgY3N2LCAndXRmLTgnLCBmdW5jdGlvbihlcnIpewogICAgICAgICAgICAgIGlmIChlcnIpIHRocm93IGVycgogICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0FjaGl2ZWQuJykKICAgICAgICAgICAgfSkKICAgICAgICAgICAgaWYgKGNhbGxSZWNvcmRpbmdVcmxzLmxlbmd0aCkKICAgICAgICAgICAgICBkb3dubG9hZENhbGxSZWNvcmRpbmcoY2FsbFJlY29yZGluZ1VybHMpCiAgICAgICAgfQogICAgfSkKfQoKZnVuY3Rpb24gZG93bmxvYWRDYWxsUmVjb3JkaW5nKGNhbGxSZWNvcmRpbmdVcmxzKXsKICAgIGFzeW5jLmZvckVhY2hMaW1pdChjYWxsUmVjb3JkaW5nVXJscywgMSwgZnVuY3Rpb24ocmVjb3JkaW5nVXJsLCBuZXh0UmVjb3JkaW5nKXsKICAgICAgYXN5bmMud2F0ZXJmYWxsKFsKICAgICAgICAgIGZ1bmN0aW9uIHJlYWRSZWNvcmRpbmcoZG9uZSkgewogICAgICAgICAgICBjb25zb2xlLmxvZyhyZWNvcmRpbmdVcmwpCiAgICAgICAgICAgIHZhciB1cmxQYXJ0cyA9IHJlY29yZGluZ1VybC5zcGxpdCgiLyIpCiAgICAgICAgICAgIHZhciBmaWxlTmFtZSA9ICJyZWNvcmRpbmdzLyIgKyB1cmxQYXJ0c1t1cmxQYXJ0cy5sZW5ndGgtMV0KICAgICAgICAgICAgZXYuc2F2ZV9jYWxsX3JlY29yZGluZyhyZWNvcmRpbmdVcmwsIGZpbGVOYW1lLCAoZXJyLCByZXNwb25zZSkgPT4gewogICAgICAgICAgICAgIGlmIChlcnIpCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygiRG93bmxvYWQgZmlsZSBmYWlsZWQuIikKICAgICAgICAgICAgICBkb25lICgpCiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgXSwgZnVuY3Rpb24gKGVycm9yLCBzdWNjZXNzKSB7CiAgICAgICAgICAgIGlmIChlcnJvcikgewogICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdTb21lIGVycm9yIScpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnNvbGUubG9nKCJEb3dubG9hZCBuZXh0IGNhbGwgcmVjb3JkaW5nLi4uIikKICAgICAgICAgICAgbmV4dFJlY29yZGluZygpCiAgICAgICAgfSk7CiAgICB9LCBmdW5jdGlvbihlcnIpewogICAgICAgIGNvbnNvbGUubG9nKCJEb3dubG9hZCBjYWxsIHJlY29yZGluZ3MgY29tcGxldGVkISIpOwogICAgfSk7Cn0K</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><div class="saurus-file-actions"><a href="https://github.com/ringcentral-tutorials/engagevoice-call-recordings-node" target="_blank" class="explorer-get-code"><i class="fa fa-lg fa-github-square"></i>View Code on GitHub</a><a href="https://github.com/ringcentral-tutorials/engagevoice-call-recordings-node/archive/master.zip" target="_blank" class="explorer-get-code"><i class="fa fa-lg icon-download"></i>Download Source Code</a></div></div></div></div><footer><div class="footer-content"><div class="footer-content-row layout-2-cols"><div class="footer-content-row-left"><div class="footer-logo"><a href="http://www.ringcentral.com"><span>Back to the main site</span></a></div></div><div class="footer-content-row-right"><ul class="footer-text-links"><li><a href="http://www.ringcentral.com/legal.html" target="_blank"><span>Legal</span></a></li><li><a href="http://www.ringcentral.com/security-statement.html" target="_blank"><span>Security Policy</span></a></li><li><a href="http://www.ringcentral.com/legal/privacy-policy.html" target="_blank"><span>Privacy Policy</span></a></li><li><a ng-href="https://devcommunity.ringcentral.com" target="_blank" href="https://devcommunity.ringcentral.com"><span>Community</span></a></li><li><a href="https://medium.com/ringcentral-developers" target="_blank"><span>Blog</span></a></li></ul></div></div><div class="footer-content-row footer-content-row-last layout-2-cols"><div class="footer-content-row-left"><span class="footer-copyright">Â© 1999-<span ng-bind="::main.nowObj|date:'yyyy'" class="footer-copyright-to ng-binding">2017</span> RingCentral, Inc. All rights reserved.</span></div><div class="footer-content-row-right"><div class="footer-image-links"><div class="footer-image-link footer-image-link-facebook"><a target="_blank" href="http://www.facebook.com/ringcentral"><i class="fa icon-facebook"></i></a></div><div class="footer-image-link footer-image-link-twitter"><a target="_blank" href="http://twitter.com/ringcentraldevs"><i class="fa icon-twitter"></i></a></div><div class="footer-image-link footer-image-link-google-plus"><a target="_blank" href="https://www.google.com/+ringcentral"><i class="fa icon-google_plus"></i></a></div><div class="footer-image-link footer-image-link-linkedin"><a target="_blank" href="http://www.linkedin.com/company/ringcentral"><i class="fa icon-linkedin"></i></a></div><div class="footer-image-link footer-image-link-youtube"><a target="_blank" href="http://www.youtube.com/ringcentral"><i class="fa icon-youtube"></i></a></div></div></div></div></div></footer></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script><script>window.tutorialName="Learn how to read call metadata and download call recordings using Node JS";</script><script src="viewsaurus.js"></script></body></html>